<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Blazing â€” Manual Background Switch (Responsive)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="css/background.css?v=2" />
  <link rel="stylesheet" href="css/top-bar.css?v=2" />
  <link rel="stylesheet" href="css/character-vignette.css?v=2" />
  <link rel="stylesheet" href="css/dashboard.css?v=2" />
  <link rel="stylesheet" href="css/summon-banner-carousel.css?v=2" />
  <link rel="stylesheet" href="css/ui-layout.css?v=2" />
</head>

<body>
  <!-- Default background -->
  <div id="full-bg" class="bg-1"></div>

  <!-- Character Vignette Display -->
  <div class="character-vignette-container"></div>

  <!-- Vignette Edge Fading Effect -->
  <div class="vignette-overlay"></div>

  <!-- Wind Animation Particles -->
  <div class="wind-container"></div>

  <!-- Top Bar Overlay - Ninja Rank, Username & Currency HUD -->
  <div class="top-bar">
    <!-- Left: Ninja Rank -->
    <div class="ninja-rank-container">
      <span class="ninja-rank-label">Ninja Rank:</span>
      <span class="ninja-rank-value" id="ninja-rank-value">1</span>
    </div>

    <!-- Center: Player Username -->
    <div class="username-container">
      <div class="username-holder">
        <span class="username-text" id="username-display">Ninja</span>
      </div>
    </div>

    <!-- Right: Currency HUD -->
    <div class="currency-hud">
      <div class="currency-item ninja-pearls">
        <img src="assets/icons/currency/ninjapearl.png" alt="Ninja Pearls" class="currency-icon"
             onerror="this.style.display='none';">
        <span class="currency-amount" id="currency-ninja-pearls">0</span>
      </div>
      <div class="currency-item shinobites">
        <img src="assets/icons/currency/shinobite.png" alt="Shinobites" class="currency-icon"
             onerror="this.style.display='none';">
        <span class="currency-amount" id="currency-shinobites">0</span>
      </div>
      <div class="currency-item ryo">
        <img src="assets/icons/currency/ryo.png" alt="Ryo" class="currency-icon"
             onerror="this.style.display='none';">
        <span class="currency-amount" id="currency-ryo">0</span>
      </div>
    </div>
  </div>

  <!-- Summon Banner Carousel (Left Side) -->
  <div class="summon-banner-carousel">
    <!-- Dynamically populated by navigation.js -->
  </div>

  <!-- Right Banner Panel (5 Main Navigation Banners) -->
  <div class="right-banner-panel">
    <div class="banner-button missions">
      <div class="banner-button-text">Missions</div>
    </div>
    <div class="banner-button characters">
      <div class="banner-button-text">Characters</div>
    </div>
    <div class="banner-button summon">
      <div class="banner-button-text">Summon</div>
    </div>
    <div class="banner-button fusion">
      <div class="banner-button-text">Fusion</div>
    </div>
    <div class="banner-button shop">
      <div class="banner-button-text">Shop</div>
    </div>
  </div>

  <!-- Bottom Icon Bar (10 Utility Icons) -->
  <div class="bottom-icon-bar">
    <!-- Notice -->
    <div class="bottom-icon" data-action="notice">
      <img src="assets/icons/notice_icon.png" alt="Notice" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Notice</span>
    </div>

    <!-- Present Box -->
    <div class="bottom-icon" data-action="presents">
      <img src="assets/icons/present_icon.png" alt="Presents" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Presents</span>
    </div>

    <!-- Achievements -->
    <div class="bottom-icon" data-action="achievements">
      <img src="assets/icons/achievement_icon.png" alt="Achievements" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Achievements</span>
    </div>

    <!-- Panel Missions -->
    <div class="bottom-icon" data-action="panel-missions">
      <img src="assets/icons/panel_missions_icon.png" alt="Panel Missions" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Panel</span>
    </div>

    <!-- Chat -->
    <div class="bottom-icon" data-action="chat">
      <img src="assets/icons/chat_icon.png" alt="Chat" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Chat</span>
    </div>

    <!-- Inventory -->
    <div class="bottom-icon" data-action="inventory">
      <img src="assets/icons/inventory_icon.png" alt="Inventory" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Inventory</span>
    </div>

    <!-- Teams -->
    <div class="bottom-icon" data-action="teams">
      <img src="assets/icons/teams_icon.png" alt="Teams" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Teams</span>
    </div>

    <!-- Resources -->
    <div class="bottom-icon" data-action="resources">
      <img src="assets/icons/resources_icon.png" alt="Resources" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Resources</span>
    </div>

    <!-- Guilds -->
    <div class="bottom-icon" data-action="guilds">
      <img src="assets/icons/guilds_icon.png" alt="Guilds" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Guilds</span>
    </div>

    <!-- Settings -->
    <div class="bottom-icon" data-action="settings">
      <img src="assets/icons/settings_icon.png" alt="Settings" class="bottom-icon-image" onerror="this.style.display='none';">
      <span class="bottom-icon-label">Settings</span>
    </div>
  </div>

  <!-- Music Control Panel -->
  <div class="music-control-panel" id="music-panel">
    <div class="music-control-header">
      <h3>Music</h3>
      <button class="music-toggle-btn" id="music-collapse-btn" title="Toggle Panel">âˆ’</button>
    </div>
    <div class="music-controls">
      <div class="music-buttons">
        <button class="music-btn" id="music-play-btn" title="Play Music">â–¶</button>
        <button class="music-btn" id="music-mute-btn" title="Mute">ðŸ”Š</button>
      </div>
      <div class="music-volume-control">
        <div class="music-volume-label">Volume</div>
        <div class="music-volume-slider-container">
          <input type="range" min="0" max="100" value="50" class="music-volume-slider" id="music-volume-slider">
          <span class="music-volume-display" id="music-volume-display">50%</span>
        </div>
      </div>
      <div class="music-visualizer">
        <div class="music-visualizer-bar"></div>
        <div class="music-visualizer-bar"></div>
        <div class="music-visualizer-bar"></div>
        <div class="music-visualizer-bar"></div>
        <div class="music-visualizer-bar"></div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/character_inv.js?v=2"></script>
  <script src="js/resources.js?v=2"></script>
  <script src="js/daily-missions.js?v=2"></script>
  <script src="js/top-bar.js?v=2"></script>
  <script src="js/character-vignette.js?v=2"></script>
  <script src="js/username.js?v=2"></script>
  <script src="js/navigation.js?v=2"></script>

  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      console.log("âœ… JavaScript loaded!");

      // Initialize username display
      const usernameDisplay = document.getElementById("username-display");
      if (usernameDisplay && typeof window.UserProfile !== "undefined") {
        const username = window.UserProfile.getUsername();
        usernameDisplay.textContent = username;
        console.log(`ðŸ‘¤ Username loaded: ${username}`);

        // Listen for username changes
        window.addEventListener("usernameChanged", (e) => {
          usernameDisplay.textContent = e.detail.username;
          console.log(`ðŸ‘¤ Username updated: ${e.detail.username}`);
        });
      }

      // Initialize Dashboard Systems
      console.log("ðŸŽ® Initializing Dashboard Systems...");

      // Initialize Calendar and Daily Streak
      if (window.DashboardCalendar) {
        window.DashboardCalendar.init();
        await updateDailyLoginDisplay();
      }

      // Initialize Mailbox
      if (window.DashboardMailbox) {
        window.DashboardMailbox.init();
        updateMailboxBadge();
      }

      // Initialize Stats
      if (window.DashboardStats) {
        await window.DashboardStats.init();
        updateCollectionStats();
      }

      // Initialize Announcements
      if (window.DashboardAnnouncements) {
        await window.DashboardAnnouncements.init('announcement-banner-container');
      }

      // Initialize Banner Slideshow
      if (window.DashboardBannerSlideshow) {
        await window.DashboardBannerSlideshow.init('dashboard-banner-slideshow');
      }

      // Update Ninja Rank Progress Bar
      updateRankProgressBar();

      // Process login bonus
      if (typeof window.DailyMissions !== "undefined") {
        const loginResult = await window.DailyMissions.processLogin();
        if (loginResult.ok && !loginResult.alreadyClaimed) {
          const rewardText = Object.entries(loginResult.reward)
            .map(([mat, amt]) => `${mat}: ${amt}`)
            .join(", ");
          alert(`Login Bonus Day ${loginResult.loginDay}!\n\nRewards:\n${rewardText}`);
        }
      }

      console.log("âœ… All systems initialized!");
    });
  </script>
</body>
</html>
